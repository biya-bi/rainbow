<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:cps="http://xmlns.jcp.org/jsf/composite/cps"
	xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:body>
	<cps:trackableDataGrid id="productList"
		title="#{labels.ListProductsTitle}"
		dataSource="#{productLazyDataModel}"
		selectedItem="#{productController.current}" selectedValue="#{item.id}"
		createActionListener="#{productController.prepareCreate()}"
		createDialog="productCreateDialog" createUpdate=":productCreate:form"
		editDialog="productEditDialog" editUpdate=":productEdit:form"
		detailsDialog="productDetailsDialog"
		detailsUpdate=":productDetails:form"
		deleteDialog="productDeleteDialog" deleteUpdate=":productDelete:form"
		columnToggleListener="#{productController.onToggle}"
		creatorFilterValue="#{productLazyDataModel.creatorFilter.value}"
		creatorFilterOperator="#{productLazyDataModel.creatorFilter.operator}"
		updaterFilterValue="#{productLazyDataModel.updaterFilter.value}"
		updaterFilterOperator="#{productLazyDataModel.updaterFilter.operator}"
		creationDateFilterValue="#{productLazyDataModel.creationDateFilter.value}"
		creationDateFilterOperator="#{productLazyDataModel.creationDateFilter.operator}"
		lastUpdateDateFilterValue="#{productLazyDataModel.lastUpdateDateFilter.value}"
		lastUpdateDateFilterOperator="#{productLazyDataModel.lastUpdateDateFilter.operator}"
		creatorColumnVisible="#{productController.auditColumnsStates[4]}"
		updaterColumnVisible="#{productController.auditColumnsStates[5]}"
		creationDateColumnVisible="#{productController.auditColumnsStates[6]}"
		lastUpdateDateColumnVisible="#{productController.auditColumnsStates[7]}">


		<p:column headerText="#{labels.ProductCodeTitle}"
			filterBy="#{item.code}" sortBy="#{item.code}"
			filterValue="#{productLazyDataModel.codeFilter.value}">
			<h:outputText value="#{item.code}" />
			<f:facet name="footer">
				<cps:stringFilterSelectOneMenu
					changeUpdate="productList:form:dataTable"
					selectedValue="#{productLazyDataModel.codeFilter.operator}"
					changeWidgetVar="productListDataTable" />
			</f:facet>
		</p:column>

		<p:column headerText="#{labels.ProductNameTitle}"
			filterBy="#{item.name}" sortBy="#{item.name}"
			filterValue="#{productLazyDataModel.nameFilter.value}">
			<h:outputText value="#{item.name}" />
			<f:facet name="footer">
				<cps:stringFilterSelectOneMenu
					changeUpdate="productList:form:dataTable"
					selectedValue="#{productLazyDataModel.nameFilter.operator}"
					changeWidgetVar="productListDataTable" />
			</f:facet>
		</p:column>

		<p:column headerText="#{labels.ProductPriceTitle}"
			filterBy="#{item.price}" sortBy="#{item.price}"
			filterValue="#{productLazyDataModel.priceFilter.value}">
			<h:outputText value="#{item.price}" />
			<f:facet name="footer">
				<cps:comparableFilterSelectOneMenu
					changeUpdate="productList:form:dataTable"
					selectedValue="#{productLazyDataModel.priceFilter.operator}"
					changeWidgetVar="productListDataTable" />
			</f:facet>
		</p:column>

		<p:column headerText="#{labels.ProductCategoryTitle}"
			filterBy="#{item.category.name}" sortBy="#{item.category.name}"
			filterValue="#{productLazyDataModel.categoryNameFilter.value}">
			<p:commandLink update=":categoryDetails:form"
				value="#{item.category.name}"
				oncomplete="PF('categoryDetailsDialog').show()">
				<f:setPropertyActionListener value="#{item.category}"
					target="#{categoryController.current}" />
			</p:commandLink>
			<f:facet name="footer">
				<cps:stringFilterSelectOneMenu
					changeUpdate="productList:form:dataTable"
					selectedValue="#{productLazyDataModel.categoryNameFilter.operator}"
					changeWidgetVar="productListDataTable" />
			</f:facet>
		</p:column>

	</cps:trackableDataGrid>

	<ui:include src="/WEB-INF/pages/products/create.xhtml" />
	<ui:include src="/WEB-INF/pages/products/edit.xhtml" />
	<ui:include src="/WEB-INF/pages/products/details.xhtml" />
	<ui:include src="/WEB-INF/pages/products/delete.xhtml" />

	<ui:include src="/WEB-INF/pages/quickCreate/create_category.xhtml" />
	<ui:include src="/WEB-INF/pages/categories/details.xhtml" />

</h:body>
</html>

